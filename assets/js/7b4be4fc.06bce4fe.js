(self.webpackChunkfossology_blogs=self.webpackChunkfossology_blogs||[]).push([[8842],{3905:function(e,t,n){"use strict";n.d(t,{Zo:function(){return p},kt:function(){return c}});var a=n(7294);function i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function l(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function s(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?l(Object(n),!0).forEach((function(t){i(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):l(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function r(e,t){if(null==e)return{};var n,a,i=function(e,t){if(null==e)return{};var n,a,i={},l=Object.keys(e);for(a=0;a<l.length;a++)n=l[a],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,t);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(a=0;a<l.length;a++)n=l[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}var o=a.createContext({}),u=function(e){var t=a.useContext(o),n=t;return e&&(n="function"==typeof e?e(t):s(s({},t),e)),n},p=function(e){var t=u(e.components);return a.createElement(o.Provider,{value:t},e.children)},d={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},h=a.forwardRef((function(e,t){var n=e.components,i=e.mdxType,l=e.originalType,o=e.parentName,p=r(e,["components","mdxType","originalType","parentName"]),h=u(n),c=i,m=h["".concat(o,".").concat(c)]||h[c]||d[c]||l;return n?a.createElement(m,s(s({ref:t},p),{},{components:n})):a.createElement(m,s({ref:t},p))}));function c(e,t){var n=arguments,i=t&&t.mdxType;if("string"==typeof e||i){var l=n.length,s=new Array(l);s[0]=h;var r={};for(var o in t)hasOwnProperty.call(t,o)&&(r[o]=t[o]);r.originalType=e,r.mdxType="string"==typeof e?e:i,s[1]=r;for(var u=2;u<l;u++)s[u]=n[u];return a.createElement.apply(null,s)}return a.createElement.apply(null,n)}h.displayName="MDXCreateElement"},2153:function(e,t,n){"use strict";n.r(t),n.d(t,{frontMatter:function(){return s},metadata:function(){return r},toc:function(){return o},default:function(){return p}});var a=n(2122),i=n(9756),l=(n(7294),n(3905)),s={},r={unversionedId:"docs/UI-Architecture-Overview",id:"docs/UI-Architecture-Overview",isDocsHomePage:!1,title:"UI-Architecture-Overview",description:"The user interface (UI) is designed using a modular and (somewhat) object oriented methodology. The general design goal behind the entire UI: any single component can be replaced without needing to rebuild the entire UI.",source:"@site/docs/docs/UI-Architecture-Overview.md",sourceDirName:"docs",slug:"/docs/UI-Architecture-Overview",permalink:"/fossology-blogs/docs/docs/UI-Architecture-Overview",editUrl:"https://github.com/Aman-Codes/fossology-blogs/edit/master/docs/docs/UI-Architecture-Overview.md",version:"current",frontMatter:{},sidebar:"tutorialSidebar",previous:{title:"Introduction",permalink:"/fossology-blogs/docs/docs/Twig"},next:{title:"Writing-Agents-&-Plugins",permalink:"/fossology-blogs/docs/docs/Writing-Agents-&-Plugins"}},o=[{value:"Directory Structure",id:"directory-structure",children:[]},{value:"Common Code",id:"common-code",children:[{value:"Common Code Loading",id:"common-code-loading",children:[]},{value:"Common Code Naming Convention",id:"common-code-naming-convention",children:[]}]},{value:"Plugins",id:"plugins",children:[{value:"Plugin Flexibility",id:"plugin-flexibility",children:[]},{value:"Plugins Template",id:"plugins-template",children:[]},{value:"Plugin Process Flow",id:"plugin-process-flow",children:[]},{value:"Plugin Subtypes",id:"plugin-subtypes",children:[]},{value:"DB Plugin Caveat",id:"db-plugin-caveat",children:[]}]},{value:"Plugin Data Structure",id:"plugin-data-structure",children:[]},{value:"Sample Complex Plugin: init",id:"sample-complex-plugin-init",children:[]},{value:"Sample Complex Plugin: auth",id:"sample-complex-plugin-auth",children:[]},{value:"Menu Data Structure",id:"menu-data-structure",children:[]}],u={toc:o};function p(e){var t=e.components,n=(0,i.Z)(e,["components"]);return(0,l.kt)("wrapper",(0,a.Z)({},u,n,{components:t,mdxType:"MDXLayout"}),(0,l.kt)("p",null,"The user interface (UI) is designed using a modular and (somewhat) object oriented methodology. The general design goal behind the entire UI: any single component can be replaced without needing to rebuild the entire UI."),(0,l.kt)("h1",{id:"basic-architecture"},"Basic Architecture"),(0,l.kt)("p",null,"The UI has four key areas: common code, plugins, plugin structure, and menus structure. Each of these areas cover specific functionality:"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},(0,l.kt)("strong",{parentName:"p"},"Common code")," is effectively a shared-library of functions. Functions either perform complex computations ",(0,l.kt)("em",{parentName:"p"},"or")," format output, but not both.")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},(0,l.kt)("strong",{parentName:"p"},"Plugins")," provide specific feature-based functionality. (Want another feature? Create another plugin!) Unlike common code, plugins provide complex computations ",(0,l.kt)("em",{parentName:"p"},"and")," format output. Specifically, plugins may perform different computations based on the type of output.")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},(0,l.kt)("strong",{parentName:"p"},"Plugin structure")," is a global structure that lists every plugin, and whether or not it accessible.")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},(0,l.kt)("strong",{parentName:"p"},"Menus structure")," is a global structure used by plugins so that they can register with other plugins. "))),(0,l.kt)("p",null,"The system has been designed with a separation between computations and output. Computations do not need to be rewritten if the output alternates between a web browser, PDF document, XML file, printer, or something else."),(0,l.kt)("h2",{id:"directory-structure"},"Directory Structure"),(0,l.kt)("p",null,"The user interface directory structure is as follows:"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre"},"ui/common/  - All common code is stored here.\nui/html     - This directory contains all static HTML pages\nui/images   - This directory contains all image files\nui/plugins  - All code for plugins is stored here.\nui/template - The plugin template is stored here.\n")),(0,l.kt)("p",null,"With the web-based user interface, all URLs are relative to the ui/ directory. Thus, individual developers can have their own ui directories for software development."),(0,l.kt)("h2",{id:"common-code"},"Common Code"),(0,l.kt)("p",null,'Common code is stored in the "ui/common" directory. This code is accessible by everything in the UI: other common functions and plugins.'),(0,l.kt)("p",null,"Common code has no explicit initialization; each common function must validate all dependencies. For example, if a function queries the database then it should make sure the $DB global variable is set:"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-C"},"global $DB;\nif (empty($DB)) { return; }\n")),(0,l.kt)("p",null,"For ease of maintenance, common functions have been grouped together based on feature functionality. For example, common-license.php contains functions related to license information. In this common library are functions such as:"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},"LicenseGet(): Return licenses for a specific pfile.")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},"LicenseGetAll(): Return licenses for every file under a given uploadtree_pk.")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},"LicenseSearch(): Given a license name and uploadtree_pk, return each file containing the license."))),(0,l.kt)("p",null,"Similarly, common-menu.php contains a library of menu-related functions. In common-license.php are functions like:"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},"menu_insert(): Insert an item into the menu data structure.")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},"menu_find(): Given a top-level menu name, return the list of sub-menus below it and max depth of menu.")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},"menu_to_1list(): Take a menu data structure and render it as one HTML line with items in a list."))),(0,l.kt)("p",null,'Common code is unaware of the output format. Functions that only perform computations (e.g., "find all licenses for a given file" -- the LicenseGet() function), do not format the resulting data. Before the data is sent to the output device, it must be formatted by a plugin.'),(0,l.kt)("p",null,"However, some common code functions do generate pre-formatted output. These functions should not perform complex computations. The separation ensures that different output devices only need to call output-specific formatting functions and not output-specific computations. For example, menu_to_1html() generates HTML text, but it does nothing more complicated than traversing the menu data structure."),(0,l.kt)("p",null,"Common code may have a dependency on plugins. For example, common-license.php accesses the database (via the core-db.php plugin) and common-agents.php accesses plugins that define agents. However, common code must",(0,l.kt)("em",{parentName:"p"},"always")," check to make sure the plugin exists before attempting to access it."),(0,l.kt)("h3",{id:"common-code-loading"},"Common Code Loading"),(0,l.kt)("p",null,"Common code is loaded by the file common/common.php. This PHP file is used to load all defined common files and functions. Beyond this, no initialization is performed. Specifically, common code must not perform any tasks outside of the functions since common code has no means to tell if the functionality is actually required."),(0,l.kt)("h3",{id:"common-code-naming-convention"},"Common Code Naming Convention"),(0,l.kt)("p",null,"There is no specific naming convention used for the common code files or function names. In general, files are named after the general type of task. Function names are descriptive and frequently include the type of task. For example, common-dir.php is used for identifying the directories into which uploaded FOSSology files are stored. Most of the functions begin with \"Dir\": Dir2Path() stores an uploaded item's directory as a path, and Dir2Browse() creates the yellow directory box found in the web interface's browse window and search results."),(0,l.kt)("h2",{id:"plugins"},"Plugins"),(0,l.kt)("p",null,"Plugins provide specific input/output features. For example, if you need a UI module for displaying licenses, then that functionality would be defined by a plugin."),(0,l.kt)("p",null,"Unlike common code, plugins may perform complex computations ",(0,l.kt)("em",{parentName:"p"},"and")," format the output within a single function. In fact, different computations may be formed based on the output type."),(0,l.kt)("p",null,"In addition, while common code is always available, a plugin's availability may vary based on input parameters, global settings, user permissions, and output type. Thus, a plugin may provide a very specific functionality, but may not always be accessible."),(0,l.kt)("p",null,'For maintenance, plugins are named after their generic category. For example, all of the plugins that begin with "admin-" (e.g., admin-db-vacuum.php and admin-upload-delete.php) perform administrative functions. The "ui-" plugins (e.g., ui-topnav.php and ui-welcome.php) are closely tied to the HTML web-based user interface. And the "jobs-" plugins (e.g., jobs-runningjobs.php and jobs-showjobs-upload.php) handle job-oriented tasks.'),(0,l.kt)("p",null,'While plugins are intended to process input and output, they may not actually generate output that gets displayed. For example, the command-line tool "fossjobs" (cli/fossjobs.php) uses the menu data structure to find all plugins for analysis agents, and calls plugin functions for scheduling analysis. However, the plugins do not actually generate the output for fossjobs.'),(0,l.kt)("h3",{id:"plugin-flexibility"},"Plugin Flexibility"),(0,l.kt)("p",null,"Since plugins provide feature-specific functionality, adding a new feature only means adding a new plugin (hence the name: plugging in a new feature). Similarly, changing a specific feature only requires altering the specific plugin."),(0,l.kt)("p",null,"As an example, the web-based user interface for FOSSology has gone through a number of iterations. Some had the menu at the top, others had the menu down the side. Some versions used HTML frames, while the current version does not use frames. All of these changes were limited to very specific plugins:"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},"ui/plugins/ui-menus.php: This renders the user menu bar. To change the menu bar, you only need to alter this plugin.")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},'ui/plugins/ui-topnav.php: The "topnav" plugin defines the main window used by FOSSology. It has a dependency on ui-menus.php, so topnav calls menus. Changing this plugin alters the entire web page layout.')),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},'ui-treenav.php: This renders the folder tree seen when you click the "Browse" button in the web interface\'s menu.'))),(0,l.kt)("h3",{id:"plugins-template"},"Plugins Template"),(0,l.kt)("p",null,"All plugins are based off of a PHP template called FO_Plugin (ui/template/template-plugin.php). The template defines some public variables that are used for organizing plugins, and some methods common to all plugins."),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-C"},"class FO_Plugin\n{\n  // All public fields can be empty, indicating that it does not apply.\n  var $State=PLUGIN_STATE_INVALID;\n")),(0,l.kt)("p",null,"The $State variable identifies whether the plugin is ready, initialized, partially initialized (not yet ready), or unavailable."),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-C"},'var $Name="";\n')),(0,l.kt)("p",null,"$Name defines the official name of this plugin. The name does not need to be the same as the PHP filename. Other plugins will look for this plugin based on this name."),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-C"},'var $Version="1.0";\n')),(0,l.kt)("p",null,"The $Version variable permits multiple plugins to have the same name. Only the plugin with the highest version number will be found when searching for a plugin by name (see plugin_find_id() in common/common-plugin.php). The version is very useful for development since you can replace a plugin by having a different file with the same $Name and a newer $Version."),(0,l.kt)("p",null,"Although plugins can generate any type of output, they are currently used to generate HTML. Thus, there are some variables used to define HTML values and web-based functionality:"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-C"},"var $Title=\"\";  // used for HTML title tags and window menu bars\nvar $NoMenu=0;        /* 1 = Don't show the HTML menu at the top of page */\nvar $NoHeader=0;      /* 1 = Don't show the HTML header at the top of page */\nvar $NoHTML=0;        /* 1 = Don't add any HTML to the output */\n")),(0,l.kt)("p",null,"A plugin's availability may be dependent on some other plugin's availability:"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-C"},"var $PluginLevel=10; /* used for sorting plugins -- higher comes first after dependencies are met */\nvar $Dependency = array(); /* an array of $Name found in the required plugins */\nvar $InitOrder=0; /* during initialization, some plugins may need to come first; higher is initialized first\n")),(0,l.kt)("p",null,'Dependencies must not be cyclical. If "A" depends on "B" and "B" depends on "A", then neither will load because the dependency of "must be loaded before" is never met.'),(0,l.kt)("p",null,"Finally, plugins may want to register with the main menu:"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-C"},"var $MenuList=NULL;\nvar $MenuOrder=0;\nvar $MenuTarget=NULL;\n")),(0,l.kt)("p",null,'For example, to define an "About" menu item under the "Help" menu:'),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-C"},'var $MenuList = "Help::About";\nvar $MenuOrder=0;\n')),(0,l.kt)("p",null,'And a "delete" agent under the tool, administration menu and displaying in a new window would use:'),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-C"},'var $MenuList = "Tools::Administration::Delete";\nvar $MenuOrder=0;\nvar $MenuTarget="_new"; /* HTML <a target="_new"> */\n')),(0,l.kt)("h3",{id:"plugin-process-flow"},"Plugin Process Flow"),(0,l.kt)("p",null,'All plugins are based on a template that defines universal functionality. For example, every plugin has a function called "Initialize()". The plugin may override the default function for plugin-specific needs, but the function always exists. The default functions are as follows:'),(0,l.kt)("h4",{id:"during-software-installation"},(0,l.kt)("strong",{parentName:"h4"},"During software installation")),(0,l.kt)("p",null,"The following functions are only called when source code is placed on the system. They are intended to perform any system-specific configurations prior to using the plugin."),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},(0,l.kt)("strong",{parentName:"p"},"Install()"),". This function is only called when the UI is first installed. It should make sure all requirements are available and create anything it needs to run. For example, if a database table needs default initialization values, then this function can add it. A failed install is not inserted in the system. Since Install() may be called multiple times, it must check that changes are needed ",(0,l.kt)("em",{parentName:"p"},"before")," doing any changes. Also, it must check for partial installs in case the user is recovering from an installation failure.")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},(0,l.kt)("strong",{parentName:"p"},"Remove()"),". The opposite of Install(). This is only called when the plugin is removed from the system."))),(0,l.kt)("p",null,"The Install() functions are called by the fossinit command-line program. The 'fossinit' program is a simple UI that loads all plugins and runs every Install() function."),(0,l.kt)("p",null,'Currently, there is no "fossremove" script, so the Remove() function is not used. When it is eventually created, this will remove tables, values, and dependent files that are only used by this plugin.'),(0,l.kt)("h4",{id:"per-instantiation"},(0,l.kt)("strong",{parentName:"h4"},"Per Instantiation")),(0,l.kt)("p",null,"Each time a UI (web or command-line) loads the plugins, the following functions are accessed:"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},(0,l.kt)("strong",{parentName:"p"},"Initialize()"),": This is called once per instantiation, before the plugin is used. It should assume that Install() was already run one time (possibly years ago and not during this object's current instantiation). The big reminder: This function must ",(0,l.kt)("strong",{parentName:"p"},"not")," assume that other plugins are installed, including the database.")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},(0,l.kt)("strong",{parentName:"p"},"PostInitialize()"),": This function is called before the plugin is used and after all plugins have been initialized. If there is any initialization step that is dependent on other plugins, put it here. The default function registers the plugin with the main menu. ",(0,l.kt)("strong",{parentName:"p"},"Note"),": This function is only called if all dependencies are met.")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},(0,l.kt)("strong",{parentName:"p"},"RegisterMenus()"),": While menus can be added to any time at or after the PostInitialize phase, this is the standard location for registering this item with menus. This is intended for cross-plugin registration and not for the main menu."))),(0,l.kt)("p",null,"At this point, the plugin is fully initialized and ready for operation. Calling function may call Action() to perform a default action, OutputOpen()/Output()/OutputClose() to generate output, or OutputSet()/Output()/OutputUnset() to generate output that will be included within other output."),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},(0,l.kt)("strong",{parentName:"p"},"Action()"),": This function is used to perform a specific action.")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},(0,l.kt)("strong",{parentName:"p"},"OutputOpen()"),": This function is called when user output is requested. This function is responsible for assigning output-specific headers.")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},(0,l.kt)("strong",{parentName:"p"},"OutputSet()"),": Similar to OutputOpen, this sets the output type for this object. However, this does NOT change any global settings. This is called when this object is a dependency for another object.")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},(0,l.kt)("strong",{parentName:"p"},"Output()"),": This function is called when user output is requested. This function is responsible for content. OutputOpen() and Output() are separated so one plugin can call another plugin's Output().")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},(0,l.kt)("strong",{parentName:"p"},"OutputClose()"),": This function is called when user output is done. It generates output-specific footers.")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},(0,l.kt)("strong",{parentName:"p"},"OutputUnSet()"),": Similar to OutputClose, this ends the output type for this object. However, this does NOT change any global settings. This is called when this object is a dependency for another object."))),(0,l.kt)("p",null,"After the UI completes, the instantiated plugins are removed."),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("strong",{parentName:"li"},"Destroy()"),": This is a destructor called after the plugin is no longer needed. It should assume that PostInitialize() was already run one time (this session) and succeeded.")),(0,l.kt)("h3",{id:"plugin-subtypes"},"Plugin Subtypes"),(0,l.kt)("p",null,"Some groups of plugins have additional, standardized functions. Any other plugin with a dependency on these specific subclasses can assume that these standardized functions exist (see Plugin Structure)."),(0,l.kt)("p",null,'For example, every "agent" plugin (plugin for scheduling an analysis task) has two additional functions:'),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},(0,l.kt)("strong",{parentName:"p"},"AgentCheck()"),": This function determines whether a job is already in the jobqueue.")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},(0,l.kt)("strong",{parentName:"p"},"AgentAdd()"),": This function adds the agent to the jobqueue.")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},'Every agent that registers itself with the "agent" menu structure must have both of these functions defined.'))),(0,l.kt)("p",null,'As another example, every "upload-" plugin (plugin used for uploading a file into the FOSSology system) has a function called ',(0,l.kt)("strong",{parentName:"p"},"Upload()"),"."),(0,l.kt)("p",null,'The use of these standardized functions simplifies the implementation in other plugins. For example, a UI plugin for selecting an analysis method does not need to know about every individual "agent" plugin. Instead, it can access the list of plugins that registered as agents and can call a generic method to see if the agent needs to be scheduled for analysis. If a new analysis agent is added to the system, then no other code needs to be modified in order to use the new agent.'),(0,l.kt)("h3",{id:"db-plugin-caveat"},"DB Plugin Caveat"),(0,l.kt)("p",null,"For FOSSology, most plugins and common code access the database. Typically, one would think that the widely-used database access code would be a common-code library. However, the actual database connection and query code is located in a plugin (ui/plugins/core-db.php) and not in common code. This is intentional and done for the following reasons:"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},"The database is an input/output system. Plugins are used for managing input/output.")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},"The database requires an initialization phase to establish the DB connection. Common code cannot provide this, but plugins do.")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},"The database is a dependency used by many different plugins. If the database cannot be accessed (e.g., DB is offline), then the dependency should fail. Since plugins have a concept of dependencies, the database code should be a plugin. (Remember: common code is always available and the DB could be unavailable.)")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},"The database code is currently hard-coded for using PostgreSQL. If you want to use a different database, then you just need to replace the database plugin. This plugin abstraction is an advantage over using direct DB or PostgreSQL library calls."))),(0,l.kt)("p",null,'Because the database is widely used by the entire system, the class pointer for the database plugin is stored in a global variable: $DB. The database plugin is the only plugin referenced directly by a global variable. For example, $DB->Action("$SQL");'),(0,l.kt)("h2",{id:"plugin-data-structure"},"Plugin Data Structure"),(0,l.kt)("p",null,"Each time FOSSology is accessed, the plugins are initialized and register with a global plugin structure (see the Plugin Process Flow diagram). This data structure tracks each plugin, common-name, and its state."),(0,l.kt)("p",null,'Plugins may have a dependency on one or more other plugins. This dependency is defined in the (template-defined) array "$Dependency". For example, viewing the license histogram (ui/plugins/ui-license.php with common name "license") has a dependency on plugins with common names "db", "browse", and "view-license".'),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-C"},'class ui_license extends FO_Plugin\n  {\n  var $Name       = "license";\n  var $Title      = "License Browser";\n  var $Version    = "1.0";\n  var $Dependency = array("db","browse","view-license");\n  ...\n')),(0,l.kt)("p",null,"What this means is that the license plugin will not be postinitialized if any of these dependencies are missing. In effect, this feature will not exist unless all dependencies are met."),(0,l.kt)("p",null,"Plugins may use other plugins that are not explicitly listed as dependencies. This allows plugins to exist and work even if an optional dependency does not exist. However, the plugin must not assume that an optional dependency is initialized before the plugin, itself, initializes. To check for optional dependencies, there is a function in common-plugin.php called plugin_find_id(). If the desired plugin exists, then an id will be returned."),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-C"},'if (plugin_find_id("view-license") >= 0)\n{\n  // plugin_find_id("view-license") is the index into the array of plugins.\n  $ModLicView = &$Plugins[plugin_find_id("view-license")];\n}\n')),(0,l.kt)("p",null,'A plugin may choose not to initialize based on input and global settings. For example, there is a plugin called "core-init.php". This provides a feature with the common name "init". This plugin only initializes when a global flag indicates that the system is being installed and needs to be initialized.'),(0,l.kt)("p",null,'Plugins also have the ability to alter the states of other plugins. For example, the "init" (core-init.php) and "auth" (core-auth.php) plugins both disable other plugins. This way, uninitialized plugins are not accessessible and users who are not authenticated (feature provided by the "auth" plugin) cannot access some other plugins.'),(0,l.kt)("h2",{id:"sample-complex-plugin-init"},"Sample Complex Plugin: init"),(0,l.kt)("p",null,"The core-init.php plugin is only used when code is installed on the system. This plugin is responsible for ensuring that every other plugin does not run until the database has been properly configured and the Install() function has been called."),(0,l.kt)("p",null,'The init plugin (ui/plugins/core-init.php) has a non-default PostInitialize() function. This function looks for a semaphore that indicates the need for an initialization. The semaphore, a file named "init.ui" in the UI directory, denotes the semaphore. If the file exists then an initialization is required. If the semaphore does not exist, then this plugin disables itself.'),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-C"},'$Filename = getcwd() . "/init.ui";\nif (!file_exists($Filename))\n{\n   $this->State = PLUGIN_STATE_INVALID;\n   return;\n}\n')),(0,l.kt)("p",null,"The second thing init does is disable all other plugins. Since plugins are loaded in dependency order, every plugin already fully-initialized must be a dependency; thus, they are kept running. All other plugins are disabled (state set to 'INVALID') before they can become initialized. Disabling plugins ensures that they will not be initialized before they are installed."),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-C"},'$Max = count($Plugins);\nfor($i=0; $i < $Max; $i++)\n{\n  $P = &$Plugins[$i];\n  if ($P->State h5. PLUGIN_STATE_INVALID) { continue; }\n  /* Don\'t turn off plugins that are already up and running. */\n  if ($P->State  PLUGIN_STATE_READY) { continue; }\n  if ($P->DBaccess h5. PLUGIN_DB_DEBUG) { continue; }\n  $Key  array_search($P->Name,$this->Dependency);\n  if (($Key h4. FALSE) && strcmp($P->Name,$this->Name))\n  {\n     // print "Disable " . $P->Name . " as $Key <br>\\n";\n     $P->Destroy();\n     $P->State  PLUGIN_STATE_INVALID;\n     }\n}\n\nFinally, the init plugin adds itself to the menu. This gives web users the menu option "Admin::Initialize".\n\n```C\nif ((@$_SESSION[\'UserLevel\'] >= PLUGIN_DB_USERADMIN) && ($this->MenuList !h5. ""))\n{\n    menu_insert("Main::" . $this->MenuList,$this->MenuOrder,$this->Name,$this->MenuTarget);\n}\n')),(0,l.kt)("p",null,"The core-init.php plugin works closely with the core-schema.php plugin. Init disables all plugins and schema configures the system."),(0,l.kt)("p",null,"The init Output() function calls the ApplySchema() public function, found in ui/plugins/core-schema.php. This adds any missing tables, columns, views, etc. removes unused tables/columns/views/etc., inserts any missing default values, and runs every Install() function on every plugin."),(0,l.kt)("p",null,"From core-init.php:"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-C"},'$Schema  &$Plugins[plugin_find_any_id("schema")];\n$FailFlag = $Schema->ApplySchema($Schema->Filename,0,0);\n')),(0,l.kt)("p",null,"and from core-schema.php:"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-C"},'print "  Initializing plugins\\n"; flush();\nfor($i=0; $i < $Max; $i++)\n{\n    $P = &$Plugins[$i];\n    /* Init ALL plugins */\n    if ($Debug) { print "    Initializing plugin \'" . $P->Name . "\'\\n"; }\n    $State = $P->Install();\n    if ($State != 0)\n    {\n        $FailFlag = 1;\n        print "FAILED: " . $P->Name . " failed to install.\\n"; flush();\n        return(1);\n    }\n}\n')),(0,l.kt)("p",null,"Finally, the init plugin removes the semaphore. This ensures that future connections will not re-attempt to reconfigure the database and run Install() on every plugin."),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-C"},"$State = unlink($Filename);\n")),(0,l.kt)("h2",{id:"sample-complex-plugin-auth"},"Sample Complex Plugin: auth"),(0,l.kt)("p",null,"The auth plugin (ui/plugins/core-auth.php) enforces user-level authentication. Users without the appropriate credentials will not have access to certain plugins."),(0,l.kt)("p",null,"The Install() function ensures that the database table for 'users' contains at least one default user. Otherwise, auth will block every plugin -- including init -- from working."),(0,l.kt)("p",null,"The magic for auth happens in the PostInitialize() function. Login sessions are stored by the web server and access via the $_SESSION[] global hash."),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},"Login sessions must timeout after a period of inactivity. The $_SESSION","['time']"," variable identifies the last time the session was accessed. If it has been longer than one hour, then the session is disabled. However, the web server may enforce a faster timeout (see session.gc_maxlifetime in /etc/php5/apache2/php.ini).")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},"Logins may be restricted to a specific IP address. If the session comes from a different address (i.e., session has been hijacked) then it is disabled.")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},'If the user is not logged in, then use the "Default User" settings from the database for setting the access level. Otherwise, use the access level found in the session.')),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},"Disable every plugin that requires a higher access level."))),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-C"},"$Max = count($Plugins);\nfor($i=0; $i < $Max; $i++)\n{\n  $P = &$Plugins[$i];\n  if ($P->State h5. PLUGIN_STATE_INVALID) { continue; }\n  if (($P->DBaccess > $Level) || (empty($_SESSION['User']) && $P->LoginFlag) )\n  {\n    $P->Destroy();\n    $P->State  PLUGIN_STATE_INVALID;\n  }\n}\n")),(0,l.kt)("p",null,"The auth Output() function has two states:"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},"If the user is logged in, then log the user out and clear the $_SESSION[] structure.")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},"If the user is not logged in, then prompt for a username and password. These are compared with the database's contents. If they match, then $_SESSION[] is populated with the user's authentication level and related information."))),(0,l.kt)("h2",{id:"menu-data-structure"},"Menu Data Structure"),(0,l.kt)("p",null,'The menu data structure is used for registering plugins with other plugins. It is called "menu" because most registrations are used to render pull-down or list-based menus.'),(0,l.kt)("p",null,"This structure actually defines a suite of menu structures. Each element in the structure contains a name, sort-order, link to a plugin, HTML-specific code, URI, and a submenu. Each of these items are optional."),(0,l.kt)("p",null,"The menu structure is ordered by explicit sort priority and name. Each menu entry also defines the path through the menu. The top-most path identifies the core functional area. Everything below it is used for registration."),(0,l.kt)("p",null,"A few examples:"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},'"Main". The top-level menu "Main" is used to define the user-displayed main menu. Plugins that choose to register with the main menu are listed here. For example:')),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},"Main")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},"Home")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},"Search")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},"Browse")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},"Upload")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},"Instructions")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},"From File")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},"From Server")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},"From URL")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},"One-Shot License")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},"Organize")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},"Folders")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},"Create")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},"Delete Folder")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},"Edit Properties")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},"Move")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},"...")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},'"JobDetails". Items in this top-level menu appear as the list of available operations when viewing jobs.')),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},'"Agents". This is the default list of agents available for analysis. Every agent plugin that defines an analysis agent registers with this menu. This list is used when the user is shown a list of available agents to schedule. It is also used by command-line tools when scheduling jobs; this is the list of available agents. NOTE: agents that do not perform analysis, such as "delete upload" are not registered with this menu option. Otherwise, scheduling all of the default analysis agents will also delete the upload.'))),(0,l.kt)("p",null,'As a more detailed view, the main menu may include the following menu tree summary (found by using "Help::Debug::Debug Menus" which calls the core-debug-menus.php plugin):'),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre"},"1. Home (18 -- Default _top)\n\n 2. Search (14 -- search_file )\n\n 3. Browse (12 -- browse )\n\n 4. Upload (10 -- )\n\n    4.1. Instructions (10 -- upload_instructions )\n\n    4.2. From File (0 -- upload_file )\n\n    4.3. From Server (0 -- upload_srv_files )\n\n    4.4. From URL (0 -- upload_url )\n\n    4.5. One-Shot License (0 -- agent_license_once )\n\n 5. Organize (8 -- )\n\n    5.1. Folders (0 -- )\n\n        5.1.1. Create (0 -- folder_create )\n\n        5.1.2. Delete Folder (0 -- admin_folder_delete )\n\n        5.1.3. Edit Properties (0 -- folder_properties )\n\n        5.1.4. Move (0 -- folder_move )\n\n    5.2. License (0 -- )\n\n        5.2.1. Default Groups (0 -- license_groups_default )\n\n        5.2.2. Default Terms (0 -- license_terms_default )\n\n        5.2.3. Manage Groups (0 -- license_groups_manage )\n\n        5.2.4. Manage Terms (0 -- licterm_manage )\n\n    5.3. Uploads (0 -- )\n\n        5.3.1. Delete Uploaded File (0 -- admin_upload_delete )\n\n        5.3.2. Edit Properties (0 -- upload_properties )\n\n        5.3.3. Move (0 -- upload_move )\n\n        5.3.4. Remove License Analysis (0 -- agent_reset_license @ )\n")),(0,l.kt)("p",null,"The summary provides a quick overview of the actual menu structure. This lists the menu's name, order number (before the '--') and optional plugin associated with the menu item (after the '--'). If the resulting web page should be associated with an alternate target window, then that window name is after the '@'."),(0,l.kt)("p",null,'The full menu structure contains much more information. For example, the full "Search" menu item looks like:'),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre"},"menu Object\n\n   (\n\n   [Name] => Search\n\n   [URI] => search_file\n\n   [HTML] =>\n\n   [Order] => 14\n\n   [Target] =>\n\n   [MaxDepth] => 0\n\n   [SubMenu] =>\n\n   [FullName] => Main::Search\n\n   [Title] =>\n\n   )\n")),(0,l.kt)("p",null,"The 'FullName' is the path through the menu. The 'Name' is the text that appears in the menu. If HTML had a value, then that value would be used instead of the Name text."),(0,l.kt)("p",null,"Since this menu item appears under the 'Main' branch, it would normally be sorted alphabetically. This would make the top menu from the web browser: \"Admin Browse Help Home Jobs Organize Search Upload\". However, the unsorted ordering is not optimal for usability. The 'Order' is used to override alphabetical ordering. In this case, 'Search' has an order of 14. It will come after all menu items that have values > 14, and before all menu items that have values < 14. If there are other menu items with an order value of 14, then they will be sorted alphabetically."),(0,l.kt)("p",null,"Finally, the URI is set. Clicking on the 'Search' menu item will activate \"${URI}?mod=search_file\". This module is provided by ui/plugins/search-file.php."),(0,l.kt)("h1",{id:"error-handling"},"Error Handling"),(0,l.kt)("p",null,"For the UI, there is a large amount of error detection, but virtually no error reporting. For detection, every function validates parameters and checks return codes to ensure active calls worked properly."),(0,l.kt)("p",null,'However, while parameters are validated and calls are checked, very few errors are reported to the user. Errors are only shown to the user if there is something the user can do about it. Since FOSSology is designed for use by many different types of users, and not just administrators with root access, reporting issues such as "the database is down" or "disk full" is only useful if the user can do something about it. Depending on your user level, you may never see these errors.'),(0,l.kt)("p",null,'Instead of reporting cryptic error messages to the user, the FOSSology UI simply "does the right thing". If the right thing is to not schedule an analysis, then it is not scheduled. If the right thing is to inform the user, then the user is informed. This is very different than some applications and operating systems that constantly alert the user to errors that are beyond the user\'s control.'),(0,l.kt)("h1",{id:"security"},(0,l.kt)("strong",{parentName:"h1"},"Security")),(0,l.kt)("p",null,"The largest risk to any user interface comes from hostile input. The input may be an overflow or SQL injection, or may be an honest cut-and-paste error. From the UI's viewpoint, these are all handled the same way:"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},(0,l.kt)("strong",{parentName:"p"},"Validate data types"),". All user-supplied parameters are validate. If the input should be a number, then make sure it is a number. If it should be a string, then make sure it is a string. In ui/common/common-parm.php is a function called GetParm(). The caller provides a variable name to retrieve and the expected data type. The returned value is guaranteed to be of the correct data type.")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},(0,l.kt)("strong",{parentName:"p"},"PARM_INTEGER"),". The value is an integer. Strings that begin with numbers only return the numberic portion. Non-integers strings return 0.")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},(0,l.kt)("strong",{parentName:"p"},"PARM_NUMBER"),". Returns a floating point number. Non-numeric values return 0.0.")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},(0,l.kt)("strong",{parentName:"p"},"PARM_TEXT"),". Returns a string with backslash-quoted characters removed (see the PHP function stripslashes).")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},(0,l.kt)("strong",{parentName:"p"},"PARM_STRING"),". Decodes the URI-encoded string and returns it.")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},(0,l.kt)("strong",{parentName:"p"},"PARM_RAW"),". Performs no decoding and returns the value. The caller must validate the data type.")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},(0,l.kt)("strong",{parentName:"p"},"Validate parameters"),'. A user may include any kind of parameter in the URL. However, only expected parameters are used. Every plugin uses GetParm() to retrieve values. When constructing subsequent URLs, functions like Traceback(), Traceback_uri(), Traceback_parm(), and Traceback_parm_keep() are used. For example, the plugin ui-view.php calls "showjobs". It does not pass on every URL parameter. Instead, it constructs the URL using only the required parameters:')),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},(0,l.kt)("strong",{parentName:"p"},"No user-supplied code"),'. At no point in the UI does the user supply data that is directly used as an SQL query or executable system call. Instead, all parameters are validated. For example, the "mod=',(0,l.kt)("em",{parentName:"p"},"string"),'" parameter defines which plugin to call. The string is ',(0,l.kt)("strong",{parentName:"p"},"not")," the plugin's file name. Instead, it is a reference to a table (the plugin structure) that identifies which plugin to run. Similarly, numeric IDs are commonly passed into the UI via the URL. The GetParm() function ensures that they are numbers before they are included in any SQL query."))),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-C"},'$URI = Traceback_parm_keep(array("show","format","page","upload","item"));\n')),(0,l.kt)("h1",{id:"debugging"},(0,l.kt)("strong",{parentName:"h1"},"Debugging")),(0,l.kt)("p",null,"Developers may wish to debug the UI as new plugins are created. Some common debugging options are listed in the plugins core-debug-*.php."),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},'core-debug-plugins.php. This creates "Help::Debug::Debug Plugins". It lists every plugin in dependency order and active state. It also displays details about each plugin. This debugging code answers the question "Why didn\'t my plugin load?"')),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},'core-debug-menus.php. Along with plugins, menus are a complex structure. "Help::Debug::Debug Menus" displays every item in the menu structure. In addition, it can enable a debug flag for the web UI\'s current user (flag is restricted to your login session). When enabled, every menu item displays the full menu path and order number, and not just the text name. This debug code answers questions like "Where is my menu?" and "What menu created that item?"')),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},"core-debug-user.php. This displays information about the current user.")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},"core-debug-flush-cache.php. Some web pages are cached for speed. This debug option removes all cached entries."))),(0,l.kt)("p",null,"Other debug plugins may enable additional features or display other data structures."),(0,l.kt)("h1",{id:"program-main"},(0,l.kt)("strong",{parentName:"h1"},"Program Main")),(0,l.kt)("p",null,'For web-based access, the main program is "index.php". This is a very small program that loads all plugins and calls one plugin based on the URI "mod=" parameter. With this main program, the output type is "HTML". For example:'),(0,l.kt)("p",null,(0,l.kt)("a",{parentName:"p",href:"http://server/ui/"},"http://server/ui/")),(0,l.kt)("p",null,"is the same as"),(0,l.kt)("p",null,(0,l.kt)("a",{parentName:"p",href:"http://server/ui/?mod=Default"},"http://server/ui/?mod=Default")),(0,l.kt)("p",null,"The module 'Default' is provided by ui/plugins/ui-default.php."),(0,l.kt)("p",null,'The front of the UI does not need to be complicated. For example, there are a variety of command-line tools that simply operate as a front-end to the UI. As an example, there is a command-line program called "fossjobs". This allows the user to schedule jobs for a particular upload. The actual program loads all plugins and accesses the "Agents" menu to get the list of available jobs. Depending on the command-line parameter, it also calls the appropriate plugin to schedule the task. With this main program, plugin Output() function is not even used.'),(0,l.kt)("h1",{id:"future-enhancements"},"Future Enhancements"),(0,l.kt)("p",null,"There are a couple of things that can be done to enhance this system:"),(0,l.kt)("p",null,"Currently, every plugin and common code file is loaded every time the system is accessed. This isn't a huge problem right now, but as the system expands, this could be a performance hit. Rather than dynamically registering with the menu and plugin structures, these may become standalone tables for faster access."),(0,l.kt)("ol",null,(0,l.kt)("li",{parentName:"ol"},(0,l.kt)("p",{parentName:"li"},"PHP code can be pre-compiled. This is a good option if performance becomes an issue.")),(0,l.kt)("li",{parentName:"ol"},(0,l.kt)("p",{parentName:"li"},'There are a few common functions that mix computations with HTML output formatting. These should be split. For example, common-folders.php has a function called FolderListOption(). This function retrieves the list of folders and generates HTML output. It should be split into one function that retrieves the list (probably should populate a menu structure with the results), and a second function to turn the structure into HTML. Otherwise, a command-line text UI would need to recreate the selection function before generating output. Sadly, most of the functions in "common-folders.php" need to be rewritten.')),(0,l.kt)("li",{parentName:"ol"},(0,l.kt)("p",{parentName:"li"},'The "Action()" common function was a good idea, but really isn\'t used. Right now, it is only used by core-db.php, so it does not need to be defined in the template.')),(0,l.kt)("li",{parentName:"ol"},(0,l.kt)("p",{parentName:"li"},"All URIs should be relative to the ui/ directory. Currently ui/common/common.php loads the plugin template from the installation directory instead of the relative directory. All other files are loaded from relative locations."))))}p.isMDXComponent=!0}}]);