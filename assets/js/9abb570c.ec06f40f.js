(self.webpackChunkfossology_blogs=self.webpackChunkfossology_blogs||[]).push([[1455],{3905:function(e,t,n){"use strict";n.d(t,{Zo:function(){return p},kt:function(){return m}});var a=n(7294);function l(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function i(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(Object(n),!0).forEach((function(t){l(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function r(e,t){if(null==e)return{};var n,a,l=function(e,t){if(null==e)return{};var n,a,l={},o=Object.keys(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||(l[n]=e[n]);return l}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(l[n]=e[n])}return l}var s=a.createContext({}),u=function(e){var t=a.useContext(s),n=t;return e&&(n="function"==typeof e?e(t):i(i({},t),e)),n},p=function(e){var t=u(e.components);return a.createElement(s.Provider,{value:t},e.children)},c={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},d=a.forwardRef((function(e,t){var n=e.components,l=e.mdxType,o=e.originalType,s=e.parentName,p=r(e,["components","mdxType","originalType","parentName"]),d=u(n),m=l,k=d["".concat(s,".").concat(m)]||d[m]||c[m]||o;return n?a.createElement(k,i(i({ref:t},p),{},{components:n})):a.createElement(k,i({ref:t},p))}));function m(e,t){var n=arguments,l=t&&t.mdxType;if("string"==typeof e||l){var o=n.length,i=new Array(o);i[0]=d;var r={};for(var s in t)hasOwnProperty.call(t,s)&&(r[s]=t[s]);r.originalType=e,r.mdxType="string"==typeof e?e:l,i[1]=r;for(var u=2;u<o;u++)i[u]=n[u];return a.createElement.apply(null,i)}return a.createElement.apply(null,n)}d.displayName="MDXCreateElement"},7089:function(e,t,n){"use strict";n.r(t),n.d(t,{frontMatter:function(){return i},metadata:function(){return r},toc:function(){return s},default:function(){return p}});var a=n(2122),l=n(9756),o=(n(7294),n(3905)),i={},r={unversionedId:"docs/HACKING",id:"docs/HACKING",isDocsHomePage:!1,title:"HACKING",description:"Common settings",source:"@site/docs/docs/HACKING.md",sourceDirName:"docs",slug:"/docs/HACKING",permalink:"/fossology-blogs/docs/docs/HACKING",editUrl:"https://github.com/Aman-Codes/fossology-blogs/edit/master/docs/docs/HACKING.md",version:"current",frontMatter:{},sidebar:"tutorialSidebar",previous:{title:"Groups-and-Access-Rights-configuration",permalink:"/fossology-blogs/docs/docs/Groups-and-Access-Rights-configuration"},next:{title:"Home",permalink:"/fossology-blogs/docs/docs/Home"}},s=[{value:"Common settings",id:"common-settings",children:[]},{value:"CFLAGS",id:"cflags",children:[]},{value:"Installation location",id:"installation-location",children:[]},{value:"File Preprocessing",id:"file-preprocessing",children:[]},{value:"Clean up and testing",id:"clean-up-and-testing",children:[]},{value:"Config Files",id:"config-files",children:[]},{value:"Debugging php",id:"debugging-php",children:[]},{value:"Using Git",id:"using-git",children:[]},{value:"Coexisting installs",id:"coexisting-installs",children:[]}],u={toc:s};function p(e){var t=e.components,n=(0,l.Z)(e,["components"]);return(0,o.kt)("wrapper",(0,a.Z)({},u,n,{components:t,mdxType:"MDXLayout"}),(0,o.kt)("h2",{id:"common-settings"},"Common settings"),(0,o.kt)("p",null,"For values that you might want to adjust across the whole build tree"),(0,o.kt)("p",null,"the build system uses variables set in Makefile.conf. The build"),(0,o.kt)("p",null,"system uses these variables in all Makefiles and variables are inherited"),(0,o.kt)("p",null,"down the hierarchy. By setting variables on the make command line you"),(0,o.kt)("p",null,"can easily change things in the build"),(0,o.kt)("h2",{id:"cflags"},"CFLAGS"),(0,o.kt)("p",null,'The default CFLAGS for all C compilation is "-g -O2 -Wall". Let\'s say'),(0,o.kt)("p",null,"you wanted to build the whole tree with debugging and warnings but"),(0,o.kt)("p",null,"without optimization. You could do that with"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-Bash"},"$ make clean; make CFLAGS=-g -Wall\n")),(0,o.kt)("p",null,"or just in a particular subdir and everything below it"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-Bash"},"$ cd src/nomos/agent; make clean; make CFLAGS=-g -Wall\n")),(0,o.kt)("p",null,"Or maybe you want to build the scheduler using electricfence"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-Bash"},'$ cd src/scheduler/agent; make clean; make CFLAGS=-lefence\n``\n\n## Debugging examples\n\n```Bash\n$ make clean; make CFLAGS=-g -Wall\n$ make clean; make CFLAGS="-g -Wall"  DEFS="-D DEBUG"\n$ gdb -c core --args ./demomod  -v myfile.o\n$ valgrind --track-origins=yes --tool=memcheck --leak-check=yes ./nomos -v copyright.txt 2> valgrind.out\n')),(0,o.kt)("p",null,"For debugging the UI, xdebug is handy."),(0,o.kt)("h2",{id:"installation-location"},"Installation location"),(0,o.kt)("p",null,"All installation locations are controlled by variables as well. You can"),(0,o.kt)("p",null,"adjust the paths on the system where various files live by setting"),(0,o.kt)("p",null,"variables from Makefile.conf. You can also install to a pseudoroot, for"),(0,o.kt)("p",null,"example let's say you wanted to do a test install into a pseudoroot"),(0,o.kt)("p",null,"rather than on the system itself"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-Bash"},"$ make; make DESTDIR=/tmp/foo install\n")),(0,o.kt)("p",null,"If you are someone packaging for a distribution you want to use the paths"),(0,o.kt)("p",null,"defined by the FHS for distributions, and install to a pseudoroot so you"),(0,o.kt)("p",null,"can run your packaging results."),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-Bash"},"$ make PREFIX=/usr SYSCONFDIR=/etc/fossology LOCALSTATEDIR=/var\n$ make DESTDIR=/tmp/foo PREFIX=/usr SYSCONFDIR=/etc/fossology LOCALSTATEDIR=/var \\\n          install\n")),(0,o.kt)("p",null,"Note: PREFIX, SYSCONFDIR and LOCALSTATEDIR need to be set during the build as"),(0,o.kt)("p",null,"the location of the files using these is embedded in the binaries. But"),(0,o.kt)("p",null,"none of the other variables should need to be set at build time, only"),(0,o.kt)("p",null,"at install time."),(0,o.kt)("h2",{id:"file-preprocessing"},"File Preprocessing"),(0,o.kt)("p",null,"The build tree has a lightweight file preprocessing system. This is"),(0,o.kt)("p",null,"mainly used to load values from Makefile.conf into text or scripts that"),(0,o.kt)("p",null,"will be installed on the system. To use it:"),(0,o.kt)("ol",null,(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("p",{parentName:"li"},"Name your input file with the name you want the output file to be")),(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("p",{parentName:"li"},'with a ".in" on the end. So if you wanted the post-processed file to')),(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("p",{parentName:"li"},'be "example" then name the input file "example.in".')),(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("p",{parentName:"li"},"Edit your input file and wherever you would like to use a variable")),(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("p",{parentName:"li"},'insert "{$VARIABLE}" in the input file. While we mostly use this for')),(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("p",{parentName:"li"},"variables, you can actually use perl code if you need to.")),(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("p",{parentName:"li"},'Insert the following into your Makefile (for our "example" above),')),(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("p",{parentName:"li"},"making sure to add something to your clean target to remove the")),(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("p",{parentName:"li"},"generated file"))),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"# include the preprocessing stuff\ninclude $(TOP)/Makefile.process\n# generate the example file\nexample: example-process\n\nclean:\n    rm -f example\n")),(0,o.kt)("p",null,'Now you can also make other targets (like "all") dependent on the'),(0,o.kt)("p",null,'"example" target.'),(0,o.kt)("h2",{id:"clean-up-and-testing"},"Clean up and testing"),(0,o.kt)("p",null,"The utils/fo-cleanold utility is provided for users to be able to"),(0,o.kt)("p",null,"remove old FOSSology installs from their system, but it is also very"),(0,o.kt)("p",null,"useful in cleaning up a test system when testing installs. See the"),(0,o.kt)("p",null,"help text for additional flags to remove the database and repository."),(0,o.kt)("h2",{id:"config-files"},"Config Files"),(0,o.kt)("p",null,"By default the install and postinstall do the right thing and don't"),(0,o.kt)("p",null,"overwrite your config files. But if you do happen to want to overwrite"),(0,o.kt)("p",null,"them there are ways to do that"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("p",{parentName:"li"},"When doing 'make install' you can set the OVERWRITE variable like so # make OVERWRITE=yes install")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("p",{parentName:"li"},"When running the postinstall you can use the -o option like so # /usr/local/lib/fossology/fo-postinstall -o")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("p",{parentName:"li"},"These are also useful in testing if you want to make sure you are back")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("p",{parentName:"li"},"at a basic install."))),(0,o.kt)("h2",{id:"debugging-php"},"Debugging php"),(0,o.kt)("p",null,"If you are making changes to the web interface, you probably want to"),(0,o.kt)("p",null,"turn on error reporting. Edit the php.ini file (location dependent on"),(0,o.kt)("p",null,"your install, but probably something like /etc/php5/apache2/php.ini)"),(0,o.kt)("p",null,"and add something like:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"error_reporting  =  E_ALL & E_STRICT\n\n display_startup_errors = On\n\n log_errors = On\n\n log_errors_max_len = 0\n\n error_log = /var/log/apache2/php5.log\n")),(0,o.kt)("p",null,"The log location must be writable by the user the webserver is running"),(0,o.kt)("p",null,"as (probably www-data)."),(0,o.kt)("h2",{id:"using-git"},"Using Git"),(0,o.kt)("p",null,"The FOSSology build system is designed to properly clean up your tree of"),(0,o.kt)("p",null,'all built objects when you run a "make clean".'),(0,o.kt)("p",null,"If you want to see what outstanding differences you have to the tree"),(0,o.kt)("p",null,"you have checked out, run:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-Bash"},"$ make clean\n$ git status\n")),(0,o.kt)("p",null,"If it returns nothing then you are clean, otherwise it will list"),(0,o.kt)("p",null,"files with differences and files that git doesn't know about."),(0,o.kt)("h2",{id:"coexisting-installs"},"Coexisting installs"),(0,o.kt)("p",null,"FOSSology is designed to support coexisting installations in "),(0,o.kt)("p",null,"different locations. For example you might have distribution packages of"),(0,o.kt)("p",null,"FOSSology installed under /usr, but decide you want to try a new"),(0,o.kt)("p",null,"version from Git using the normal install process to /usr/local. This"),(0,o.kt)("p",null,"should work with the following caveats:"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("p",{parentName:"li"},"database")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("p",{parentName:"li"},"Your newer install may update the database. So your older code")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("p",{parentName:"li"},"may not work, you may even break things.")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("p",{parentName:"li"},"If you use two different databases. Adjust the Db.conf")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("p",{parentName:"li"},"files to point at separate. The one exception might be if you are")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("p",{parentName:"li"},"testing a fix of two very similar versions of the code and only")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("p",{parentName:"li"},"have one active at a time.")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("p",{parentName:"li"},"scheduler init script")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("p",{parentName:"li"},"The FHS does not define how init scripts are supposed to coexist")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("p",{parentName:"li"},"for multiple versions of the same software.")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("p",{parentName:"li"},"FOSSology always installs in /etc/init.d/fossology")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("p",{parentName:"li"},"It's up to you to decide which you want started on boot. Adjust the")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("p",{parentName:"li"},"init script accordingly (note both the scheduler and default file")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("p",{parentName:"li"},"locations) or just start the scheduler by hand.")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("p",{parentName:"li"},"apache config")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("p",{parentName:"li"},"apache works fine for two running fossology instances, but they will")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("p",{parentName:"li"},"live in different locations on the filesystem and they can't both")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("p",{parentName:"li"},"live at the same URL. Adjust accordingly.")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("p",{parentName:"li"},"User interface")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("p",{parentName:"li"},"It's easy to have two different versions of the UI operate on the same")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("p",{parentName:"li"},"DB. Just install the alternate UI in a new location and point your")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("p",{parentName:"li"},"web browser."))))}p.isMDXComponent=!0}}]);